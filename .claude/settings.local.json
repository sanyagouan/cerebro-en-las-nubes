{
  "permissions": {
    "allow": [
      "Bash(wc:*)",
      "Bash(python:*)",
      "Bash(Get-Content \"$env:APPDATA\\\\Claude\\\\claude_desktop_config.json\")",
      "Bash(Select-String -Pattern \"airtable\" -Context 0,20)",
      "mcp__notebooklm__add_notebook",
      "mcp__notebooklm__get_health",
      "mcp__memory__create_entities",
      "mcp__memory__create_relations",
      "mcp__notebooklm__list_notebooks",
      "mcp__notebooklm__ask_question",
      "mcp__context7__resolve-library-id",
      "mcp__Desktop_Commander__list_directory",
      "mcp__filesystem__search_files",
      "mcp__filesystem__read_file",
      "Bash(npm install:*)",
      "Bash(npm run build:*)",
      "Bash(npx tsc:*)",
      "mcp__filesystem__edit_file",
      "mcp__filesystem__write_file",
      "Bash(npx vite build)",
      "mcp__Desktop_Commander__start_process",
      "mcp__Desktop_Commander__write_file",
      "mcp__playwright__browser_navigate",
      "mcp__playwright__browser_click",
      "mcp__Desktop_Commander__kill_process",
      "mcp__chrome-devtools__navigate_page",
      "mcp__chrome-devtools__take_snapshot",
      "mcp__chrome-devtools__click",
      "mcp__filesystem__list_directory",
      "Bash(Get-ChildItem -Path \"C:\\\\Python*\" -ErrorAction SilentlyContinue)",
      "Bash(Select-Object -First 5 FullName)",
      "Bash(powershell -Command:*)",
      "Bash(Get-ChildItem C: -Filter \"Python*\" -Directory -ErrorAction SilentlyContinue)",
      "Bash(/c/Python313/python.exe:*)",
      "Bash(curl:*)",
      "mcp__Desktop_Commander__edit_block",
      "mcp__playwright__browser_console_messages",
      "mcp__filesystem__create_directory",
      "mcp__playwright__browser_type",
      "mcp__Desktop_Commander__interact_with_process",
      "mcp__Desktop_Commander__force_terminate",
      "Bash(taskkill:*)",
      "Bash(findstr:*)",
      "Bash(pytest:*)",
      "Bash(pip install:*)",
      "Bash(ls:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "mcp__plugin_github_github__create_pull_request",
      "Bash(PLAN_COORDINACION_DEPLOY_TESTING.md << 'HEREDOC_EOF'\n# ðŸŽ¯ PLAN DE COORDINACIÃ“N: Deploy + Testing Integrado\n\n**Fecha**: 2025-02-15  \n**Objetivo**: Coordinar deploy a Coolify + testing automatizado sin errores  \n**Estado**: â³ PROPUESTA PARA APROBACIÃ“N\n\n---\n\n## ðŸ“‹ RESUMEN EJECUTIVO\n\n### Â¿QuÃ© vamos a hacer?\n1. **Merge PR** #1 en GitHub \\(claude/serene-mccarthy â†’ dashboard-production\\)\n2. **Coolify auto-deploya** backend + frontend desde GitHub\n3. **Testing automatizado** con Playwright \\(9 tests\\)\n4. **Documentar resultados** con screenshots\n\n### Tiempo estimado: **25-35 minutos**\n\n### Herramientas MCP usadas:\n- âœ… **Playwright MCP** - Browser automation + screenshots\n- âœ… **Chrome DevTools MCP** - Network monitoring + console errors\n- âœ… **Coolify MCP** - Deploy monitoring + logs\n- âœ… **GitHub MCP** - Merge PR\n\n---\n\n## ðŸš€ FASE 1: PRE-DEPLOY \\(5 min\\)\n\n### 1.1 Verificar Coolify Status\n```\nMCP: coolify.applications.list\\(\\)\nVerificar: cerebro-backend \\(running:healthy\\) âœ…\nVerificar: cerebro-dashboard-nix \\(running\\) âœ…\n```\n\n### 1.2 Health Check Backend PRE-deploy\n```\nMCP: playwright.navigate\\(\"https://go84sgscs4ckcs08wog84o0o.app.generaia.site/health\"\\)\nEsperar: Status 200 + JSON response\n```\n\n### 1.3 Frontend Screenshot PRE-deploy\n```\nMCP: playwright.navigate\\(\"https://y08s40o0sgco88g0ook4gk48.app.generaia.site\"\\)\nMCP: playwright.screenshot\\(\"frontend-pre-deploy.png\"\\)\n```\n\n---\n\n## ðŸ”„ FASE 2: MERGE PR \\(2 min\\)\n\n### 2.1 Merge PR #1\n```\nMCP: github.merge_pull_request\\(\n  owner: \"sanyagouan\",\n  repo: \"cerebro-en-las-nubes\",\n  pullNumber: 1,\n  merge_method: \"squash\"\n\\)\n```\n\n### 2.2 Esperar Coolify Webhook\n```\nEsperar: 30 segundos\nCoolify detecta push a dashboard-production y inicia deploy\n```\n\n---\n\n## ðŸ“¦ FASE 3: MONITOREAR DEPLOY \\(5-10 min\\)\n\n### 3.1 Loop: Verificar Backend Deploy\n```\nLOOP \\(cada 30s, mÃ¡x 10 intentos\\):\n  MCP: coolify.applications.get\\(id: \"go84sgscs4ckcs08wog84o0o\"\\)\n  \n  SI status = \"running:healthy\":\n    âœ… Continuar\n  SI status = \"starting\":\n    â³ Esperar 30s mÃ¡s\n  SI status = \"exited:unhealthy\":\n    âŒ STOP - Obtener logs y reportar error\n```\n\n### 3.2 Loop: Verificar Frontend Deploy\n```\nLOOP \\(cada 30s, mÃ¡x 10 intentos\\):\n  MCP: coolify.applications.get\\(id: \"y08s40o0sgco88g0ook4gk48\"\\)\n  \n  SI status contiene \"running\":\n    âœ… Continuar\n  SI status = \"starting\":\n    â³ Esperar 30s mÃ¡s\n  SI status = \"exited\":\n    âŒ STOP - Obtener logs y reportar error\n```\n\n### 3.3 Health Check Backend POST-deploy\n```\nMCP: playwright.navigate\\(\"/health\"\\)\nVerificar: Status 200 + nuevos endpoints visibles\n```\n\n### 3.4 Health Check Frontend POST-deploy\n```\nMCP: playwright.navigate\\(frontend_url\\)\nMCP: playwright.screenshot\\(\"frontend-post-deploy.png\"\\)\nVerificar: Login visible + no console errors\n```\n\n---\n\n## ðŸ§ª FASE 4: TESTING AUTOMATIZADO \\(10 min\\)\n\n### Test 1: Backend Health âœ…\n```\nplaywright.navigate\\(\"/health\"\\)\nPASS: Status 200\n```\n\n### Test 2: Authentication Login ðŸ”\n```\n1. playwright.navigate\\(frontend\\)\n2. playwright.fill_form\\([\n     {ref: \"username\", value: \"waiter\"},\n     {ref: \"password\", value: \"waiter123\"}\n   ]\\)\n3. playwright.click\\(\"login_button\"\\)\n4. playwright.wait_for\\(text: \"Dashboard\"\\)\n5. playwright.screenshot\\(\"test-login-success.png\"\\)\nPASS: Dashboard visible\n```\n\n### Test 3: List Reservations ðŸ“‹\n```\n1. devtools.click\\(\"reservas_tab\"\\)\n2. devtools.list_network_requests\\(type: \"fetch\"\\)\n3. Verificar: GET /api/mobile/reservations â†’ 200\n4. devtools.screenshot\\(\\)\nPASS: API call OK + tabla visible\n```\n\n### Test 4: Create Reservation âž•\n```\n1. playwright.click\\(\"nueva_reserva_btn\"\\)\n2. playwright.wait_for\\(text: \"Nueva Reserva\"\\)\n3. playwright.fill_form\\([\n     {ref: \"customer_name\", value: \"Test Playwright\"},\n     {ref: \"customer_phone\", value: \"+1234567890\"},\n     {ref: \"date\", value: \"2025-02-16\"},\n     {ref: \"time\", value: \"19:00\"},\n     {ref: \"party_size\", value: \"4\"},\n     {ref: \"zone\", value: \"Interior\"}\n   ]\\)\n4. playwright.click\\(\"guardar_btn\"\\)\n5. playwright.wait_for\\(text: \"Reserva creada\"\\)\n6. playwright.screenshot\\(\"test-create-reservation.png\"\\)\nPASS: Toast de Ã©xito + nueva reserva en tabla\n```\n\n### Test 5: List Tables ðŸª‘\n```\n1. playwright.click\\(\"mesas_tab\"\\)\n2. playwright.wait_for\\(text: \"Mesas\"\\)\n3. playwright.screenshot\\(\"test-list-tables.png\"\\)\nPASS: Tabla de mesas con datos de Airtable\n```\n\n### Test 6: Create Table âž•ðŸª‘\n```\nSimilar a Test 4, pero para mesas\nPASS: Nueva mesa creada en Airtable\n```\n\n### Test 7: Update Reservation âœï¸\n```\n1. playwright.click\\(\"editar_reserva_btn\"\\)\n2. playwright.fill_form\\(cambios\\)\n3. playwright.click\\(\"guardar_btn\"\\)\n4. playwright.wait_for\\(text: \"Reserva actualizada\"\\)\nPASS: Cambios guardados\n```\n\n### Test 8: Cancel Reservation âŒ\n```\n1. playwright.click\\(\"cancelar_reserva_btn\"\\)\n2. playwright.click\\(\"confirmar_btn\"\\)\n3. playwright.wait_for\\(text: \"Reserva cancelada\"\\)\nPASS: Estado = \"Cancelada\"\n```\n\n### Test 9: Error Handling ðŸš¨\n```\n1. devtools.emulate\\({networkConditions: \"Offline\"}\\)\n2. Intentar crear reserva\n3. playwright.wait_for\\(text: \"Error\"\\)\n4. devtools.emulate\\({networkConditions: \"No emulation\"}\\)\nPASS: Error toast visible con mensaje claro\n```\n\n---\n\n## ðŸ“Š FASE 5: DOCUMENTAR \\(5 min\\)\n\n### 5.1 Actualizar INTEGRATION_TEST_RESULTS.md\n```\nCrear archivo con:\n- Resultados de 9 tests \\(PASS/FAIL\\)\n- Screenshots embebidos\n- Observaciones\n```\n\n### 5.2 Actualizar TODO list\n```\nTodoWrite\\({\n  todos: [\n    {content: \"Deploy + Testing Automatizado\", status: \"completed\"},\n    {content: \"Manual integration testing\", status: \"pending\"},\n    ...\n  ]\n}\\)\n```\n\n---\n\n## ðŸš¨ MANEJO DE ERRORES\n\n### Error 1: Deploy Falla âŒ\n**AcciÃ³n**:\n1. Obtener logs: `coolify.applications.get_logs\\(id\\)`\n2. Analizar error\n3. Reportar al usuario\n4. NO continuar con testing\n\n### Error 2: Health Check Falla despuÃ©s de Deploy ðŸ¥\n**AcciÃ³n**:\n1. Esperar 60 segundos \\(startup lento\\)\n2. Reintentar\n3. Si persiste â†’ obtener logs\n4. Reportar al usuario\n\n### Error 3: Test Automatizado Falla ðŸ§ª\n**AcciÃ³n**:\n1. Capturar screenshot\n2. Capturar console errors\n3. Documentar error\n4. CONTINUAR con siguiente test \\(no detener todo\\)\n5. Reportar todos los failures al final\n\n---\n\n## âœ… CRITERIOS DE Ã‰XITO\n\n### Deploy Exitoso ðŸš€\n- [x] Backend: `running:healthy`\n- [x] Frontend: `running:*`\n- [x] Health checks: 200 OK\n\n### Testing Exitoso ðŸ§ª\n- [x] MÃ­nimo 7/9 tests PASS \\(78%\\)\n- [x] Tests crÃ­ticos \\(Login, Health\\) PASS obligatorio\n- [x] Screenshots capturados\n\n### DocumentaciÃ³n Completa ðŸ“\n- [x] INTEGRATION_TEST_RESULTS.md actualizado\n- [x] Screenshots organizados\n- [x] TODO list actualizado\n\n---\n\n## ðŸŽ¯ COMANDO PARA EJECUTAR\n\n**Para aprobar y ejecutar este plan automÃ¡ticamente**:\n```\n\"Ejecuta el plan de coordinaciÃ³n\"\n```\n\n**Para modificar el plan**:\n```\n\"Modifica el plan: [cambios especÃ­ficos]\"\n```\n\n---\n\n## ðŸ“‹ CHECKLIST PRE-FLIGHT\n\nAntes de ejecutar, verificar:\n- [ ] PR #1 estÃ¡ listo para merge\n- [ ] Coolify webhook estÃ¡ configurado en GitHub\n- [ ] Credenciales de Coolify funcionando\n- [ ] Playwright MCP disponible\n- [ ] Chrome DevTools MCP disponible\n- [ ] Usuario aprobÃ³ este plan â­\n\n---\n\n**Creado por**: Claude Sonnet 4.5  \n**Fecha**: 2025-02-15  \n**Timing**: 25-35 minutos total  \n**Basado en**: Plan maestro `drifting-hopping-fairy.md`\nHEREDOC_EOF)",
      "mcp__playwright__browser_take_screenshot",
      "mcp__plugin_github_github__merge_pull_request",
      "mcp__playwright__browser_wait_for",
      "mcp__playwright__browser_snapshot",
      "mcp__playwright__browser_run_code",
      "mcp__plugin_github_github__get_me",
      "mcp__plugin_github_github__search_repositories",
      "mcp__plugin_github_github__list_commits",
      "mcp__plugin_github_github__get_file_contents",
      "mcp__86d21f68-5430-493d-8ce9-6b891f1c4fe2__accounts_list",
      "mcp__plugin_github_github__search_code",
      "mcp__plugin_github_github__list_branches",
      "mcp__plugin_serena_serena__read_file"
    ]
  }
}
